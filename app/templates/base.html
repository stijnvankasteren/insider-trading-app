<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ page_title or app_name }}</title>
    <link rel="icon" href="/static/logo.svg" type="image/svg+xml" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/static/site.css" />
    <script>
      (function () {
        var doc = document.documentElement;
        var isMobile = false;
        if (window.matchMedia) {
          isMobile = window.matchMedia("(max-width: 639px)").matches;
        }
        var isStandalone = false;
        if (window.matchMedia) {
          isStandalone =
            window.matchMedia("(display-mode: standalone)").matches ||
            window.matchMedia("(display-mode: fullscreen)").matches;
        }
        if (window.navigator && window.navigator.standalone) {
          isStandalone = true;
        }
        doc.classList.add(isStandalone ? "is-standalone" : "not-standalone");
        if (isMobile) {
          doc.classList.add("is-mobile");
        }
        window.__appEnv = { isStandalone: isStandalone, isMobile: isMobile };
      })();
    </script>
  </head>
  {% set path = request.url.path %}
  {% set is_app_path = path.startswith('/app') %}
  {% set home_active = path == '/' %}
  {% set pricing_active = path.startswith('/pricing') %}
  {% set about_active = path.startswith('/about') %}
  {% set subscribe_active = path.startswith('/subscribe') %}
  {% set app_menu_active = path == '/app'
      or path.startswith('/app/search')
      or path.startswith('/app/people')
      or path.startswith('/app/companies')
      or path.startswith('/app/prices')
      or path.startswith('/app/portfolio')
      or path.startswith('/app/watchlist')
      or path.startswith('/app/settings')
    %}
  {% set forms_menu_active = path.startswith('/app/3')
      or path.startswith('/app/insiders')
      or path.startswith('/app/13d')
      or path.startswith('/app/13f')
      or path.startswith('/app/8k')
      or path.startswith('/app/10k')
      or path.startswith('/app/congress')
    %}
  <body class="min-h-screen bg-slate-950 text-slate-100{% if is_app_path %} sm:overflow-hidden{% endif %}">
    {% if is_app_path %}
      <div
        id="phone-only-overlay"
        class="fixed inset-0 z-50 hidden items-center justify-center bg-slate-950/95 px-6 text-center sm:flex"
      >
        <div class="w-full max-w-md rounded-2xl border border-slate-800 bg-slate-900/80 p-6 shadow-2xl">
          <p class="text-xs uppercase tracking-[0.2em] text-slate-400">Alleen op telefoon</p>
          <h1 class="mt-3 text-2xl font-semibold">Gebruik deze app op je telefoon</h1>
          <p class="mt-2 text-sm text-slate-300">Open de app op je smartphone om verder te gaan.</p>
        </div>
      </div>
      <div
        id="standalone-required-overlay"
        class="fixed inset-0 z-50 hidden items-center justify-center bg-slate-950/95 px-6 text-center sm:hidden"
      >
        <div class="w-full max-w-md rounded-2xl border border-slate-800 bg-slate-900/80 p-6 shadow-2xl">
          <p class="text-xs uppercase tracking-[0.2em] text-slate-400">Alleen via beginscherm</p>
          <h1 class="mt-3 text-2xl font-semibold">Open via je beginscherm</h1>
          <p class="mt-2 text-sm text-slate-300">
            Voeg de app toe aan je beginscherm en open hem daarvandaan.
          </p>
          <a
            class="mt-4 inline-flex rounded-md border border-slate-700 px-4 py-2 text-xs font-semibold uppercase tracking-[0.2em] text-slate-200 hover:border-slate-500 hover:text-white"
            href="/"
          >
            Bekijk info
          </a>
        </div>
      </div>
    {% endif %}
    <header class="site-header border-b border-slate-800">
      <div class="mx-auto flex max-w-6xl items-center justify-between px-4 py-4">
        <a href="/" class="flex items-center gap-2 text-lg font-semibold tracking-tight hover:opacity-90">
          <img src="/static/logo.svg" alt="{{ app_name }} logo" class="h-7 w-7" />
          <span>{{ app_name }}</span>
        </a>
        <nav class="flex flex-wrap items-center gap-2 text-sm text-slate-300">
          <details class="relative app-only">
            <summary
              class="flex cursor-pointer list-none items-center gap-1 rounded-md px-2 py-1 {{ 'text-white' if app_menu_active else 'hover:text-white' }}"
            >
              <span>App</span>
              <svg class="h-3 w-3 text-slate-500" viewBox="0 0 12 12" fill="none" aria-hidden="true">
                <path d="M3 5l3 3 3-3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </summary>
            <div class="absolute left-0 z-20 mt-2 w-56 rounded-lg border border-slate-800 bg-slate-950 p-2 shadow-lg">
              <a
                class="block rounded-md px-2 py-1 {{ 'bg-slate-900/60 text-white' if path == '/app' else 'text-slate-300 hover:bg-slate-900/60 hover:text-white' }}"
                href="/app"
              >
                Dashboard
              </a>
              <a
                class="block rounded-md px-2 py-1 {{ 'bg-slate-900/60 text-white' if path.startswith('/app/search') else 'text-slate-300 hover:bg-slate-900/60 hover:text-white' }}"
                href="/app/search"
              >
                Search
              </a>
              <a
                class="block rounded-md px-2 py-1 {{ 'bg-slate-900/60 text-white' if path.startswith('/app/people') else 'text-slate-300 hover:bg-slate-900/60 hover:text-white' }}"
                href="/app/people"
              >
                People
              </a>
              <a
                class="block rounded-md px-2 py-1 {{ 'bg-slate-900/60 text-white' if path.startswith('/app/prices') else 'text-slate-300 hover:bg-slate-900/60 hover:text-white' }}"
                href="/app/prices"
              >
                Prices
              </a>
              <a
                class="block rounded-md px-2 py-1 {{ 'bg-slate-900/60 text-white' if path.startswith('/app/watchlist') else 'text-slate-300 hover:bg-slate-900/60 hover:text-white' }}"
                href="/app/watchlist"
              >
                Watchlist
              </a>
              <a
                class="block rounded-md px-2 py-1 {{ 'bg-slate-900/60 text-white' if path.startswith('/app/portfolio') else 'text-slate-300 hover:bg-slate-900/60 hover:text-white' }}"
                href="/app/portfolio"
              >
                Portfolio tracker
              </a>
              <a
                class="block rounded-md px-2 py-1 {{ 'bg-slate-900/60 text-white' if path.startswith('/app/settings') else 'text-slate-300 hover:bg-slate-900/60 hover:text-white' }}"
                href="/app/settings"
              >
                Settings
              </a>
            </div>
          </details>
          <details class="relative app-only">
            <summary
              class="flex cursor-pointer list-none items-center gap-1 rounded-md px-2 py-1 {{ 'text-white' if forms_menu_active else 'hover:text-white' }}"
            >
              <span>Forms</span>
              <svg class="h-3 w-3 text-slate-500" viewBox="0 0 12 12" fill="none" aria-hidden="true">
                <path d="M3 5l3 3 3-3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </summary>
            <div class="absolute left-0 z-20 mt-2 w-56 rounded-lg border border-slate-800 bg-slate-950 p-2 shadow-lg">
              <a
                class="block rounded-md px-2 py-1 {{ 'bg-slate-900/60 text-white' if path.startswith('/app/3') else 'text-slate-300 hover:bg-slate-900/60 hover:text-white' }}"
                href="/app/3"
              >
                Form 3
              </a>
              <a
                class="block rounded-md px-2 py-1 {{ 'bg-slate-900/60 text-white' if path.startswith('/app/insiders') else 'text-slate-300 hover:bg-slate-900/60 hover:text-white' }}"
                href="/app/insiders"
              >
                Form 4
              </a>
              <a
                class="block rounded-md px-2 py-1 {{ 'bg-slate-900/60 text-white' if path.startswith('/app/13d') else 'text-slate-300 hover:bg-slate-900/60 hover:text-white' }}"
                href="/app/13d"
              >
                Schedule 13D
              </a>
              <a
                class="block rounded-md px-2 py-1 {{ 'bg-slate-900/60 text-white' if path.startswith('/app/13f') else 'text-slate-300 hover:bg-slate-900/60 hover:text-white' }}"
                href="/app/13f"
              >
                Form 13F
              </a>
              <a
                class="block rounded-md px-2 py-1 {{ 'bg-slate-900/60 text-white' if path.startswith('/app/8k') else 'text-slate-300 hover:bg-slate-900/60 hover:text-white' }}"
                href="/app/8k"
              >
                Form 8-K
              </a>
              <a
                class="block rounded-md px-2 py-1 {{ 'bg-slate-900/60 text-white' if path.startswith('/app/10k') else 'text-slate-300 hover:bg-slate-900/60 hover:text-white' }}"
                href="/app/10k"
              >
                Form 10-K
              </a>
              <a
                class="block rounded-md px-2 py-1 {{ 'bg-slate-900/60 text-white' if path.startswith('/app/congress') else 'text-slate-300 hover:bg-slate-900/60 hover:text-white' }}"
                href="/app/congress"
              >
                Congress
              </a>
            </div>
          </details>
          <a class="rounded-md px-2 py-1 hover:text-white" href="/pricing">Pricing</a>
          <a class="rounded-md px-2 py-1 hover:text-white" href="/subscribe">Subscribe</a>
          <a class="rounded-md px-2 py-1 hover:text-white" href="/about">About</a>
          {% if auth_disabled %}
            <span class="rounded-md border border-slate-800 px-2 py-1 text-xs text-slate-400">
              Auth disabled
            </span>
          {% elif current_user %}
            <span class="hidden rounded-md border border-slate-800 px-2 py-1 text-xs text-slate-400 md:inline">
              {{ current_user }}
            </span>
            <a class="rounded-md px-2 py-1 hover:text-white" href="/logout">Logout</a>
          {% else %}
            <a class="rounded-md px-2 py-1 hover:text-white" href="/signup">Sign up</a>
            <a class="rounded-md px-2 py-1 hover:text-white" href="/login">Login</a>
          {% endif %}
        </nav>
      </div>
    </header>

    <div id="install-banner" class="sm:hidden">
      <div
        class="mx-auto mb-6 flex max-w-6xl items-start gap-3 rounded-xl border border-slate-800 bg-slate-900/60 px-4 py-3 text-sm text-slate-200"
      >
        <div class="flex-1">
          <p class="font-semibold">Zet deze app op je beginscherm</p>
          <p class="mt-1 text-slate-400" data-platform="ios">
            iPhone: tik op Deel en kies "Zet op beginscherm".
          </p>
          <p class="mt-1 text-slate-400" data-platform="android">
            Android: open het menu en kies "App installeren" of "Toevoegen aan startscherm".
          </p>
        </div>
        <button
          id="install-banner-close"
          class="rounded-md border border-slate-700 px-2 py-1 text-xs text-slate-300 hover:border-slate-500 hover:text-white"
          type="button"
        >
          Sluiten
        </button>
      </div>
    </div>

    <main class="mx-auto max-w-6xl px-4 py-10 pb-28 sm:pb-10">
      {% block content %}{% endblock %}
    </main>

    <nav
      id="bottom-nav-app"
      class="app-only fixed bottom-0 left-0 right-0 z-40 border-t border-slate-800 bg-slate-950/95 backdrop-blur sm:hidden"
    >
      <div
        class="mx-auto flex max-w-6xl items-center justify-between gap-2 px-3 pb-[calc(env(safe-area-inset-bottom)+0.5rem)] pt-2"
      >
        <a
          class="group flex min-w-0 flex-1 flex-col items-center gap-1 rounded-lg px-2 py-1 text-[11px] font-medium {{ 'text-white' if path == '/app' else 'text-slate-400 hover:text-white' }}"
          href="/app"
        >
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path
              d="M4 10.5l8-6 8 6v8.5a1 1 0 0 1-1 1h-4.5a1 1 0 0 1-1-1v-4.5h-5V19a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1z"
              stroke="currentColor"
              stroke-width="1.6"
              stroke-linejoin="round"
            />
          </svg>
          <span>Dashboard</span>
        </a>
        <a
          class="group flex min-w-0 flex-1 flex-col items-center gap-1 rounded-lg px-2 py-1 text-[11px] font-medium {{ 'text-white' if path.startswith('/app/search') else 'text-slate-400 hover:text-white' }}"
          href="/app/search"
        >
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <circle cx="11" cy="11" r="6" stroke="currentColor" stroke-width="1.6" />
            <path d="M16.5 16.5L20 20" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
          </svg>
          <span>Search</span>
        </a>
        <a
          class="group flex min-w-0 flex-1 flex-col items-center gap-1 rounded-lg px-2 py-1 text-[11px] font-medium {{ 'text-white' if path.startswith('/app/watchlist') else 'text-slate-400 hover:text-white' }}"
          href="/app/watchlist"
        >
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path
              d="M12 4l2.2 4.5 5 .7-3.6 3.5.9 5-4.5-2.4-4.5 2.4.9-5L4.8 9.2l5-.7z"
              stroke="currentColor"
              stroke-width="1.6"
              stroke-linejoin="round"
            />
          </svg>
          <span>Watchlist</span>
        </a>
        <a
          class="group flex min-w-0 flex-1 flex-col items-center gap-1 rounded-lg px-2 py-1 text-[11px] font-medium {{ 'text-white' if forms_menu_active else 'text-slate-400 hover:text-white' }}"
          href="/app/insiders"
        >
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path
              d="M6 3h8l4 4v14a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z"
              stroke="currentColor"
              stroke-width="1.6"
              stroke-linejoin="round"
            />
            <path d="M14 3v4h4" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round" />
            <path d="M8 12h8M8 16h6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
          </svg>
          <span>Forms</span>
        </a>
        <a
          class="group flex min-w-0 flex-1 flex-col items-center gap-1 rounded-lg px-2 py-1 text-[11px] font-medium {{ 'text-white' if path.startswith('/app/settings') else 'text-slate-400 hover:text-white' }}"
          href="/app/settings"
        >
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path
              d="M12 8.5a3.5 3.5 0 1 0 0 7 3.5 3.5 0 0 0 0-7z"
              stroke="currentColor"
              stroke-width="1.6"
            />
            <path
              d="M4 12l1.7-.3a6.7 6.7 0 0 1 .6-1.4L5 8.8l2.1-2.1 1.5 1.3c.4-.2.9-.4 1.4-.5L10.5 4h3l.3 1.7c.5.1 1 .3 1.4.5l1.5-1.3 2.1 2.1-1.3 1.5c.2.4.4.9.5 1.4L20 12l-1.7.3c-.1.5-.3 1-.5 1.4l1.3 1.5-2.1 2.1-1.5-1.3c-.4.2-.9.4-1.4.5L13.5 20h-3l-.3-1.7a6.7 6.7 0 0 1-1.4-.5l-1.5 1.3-2.1-2.1 1.3-1.5a6.7 6.7 0 0 1-.6-1.4z"
              stroke="currentColor"
              stroke-width="1.6"
              stroke-linejoin="round"
            />
          </svg>
          <span>Settings</span>
        </a>
      </div>
    </nav>

    <nav
      id="bottom-nav-info"
      class="browser-only fixed bottom-0 left-0 right-0 z-40 border-t border-slate-800 bg-slate-950/95 backdrop-blur sm:hidden"
    >
      <div
        class="mx-auto flex max-w-6xl items-center justify-between gap-2 px-3 pb-[calc(env(safe-area-inset-bottom)+0.5rem)] pt-2"
      >
        <a
          class="group flex min-w-0 flex-1 flex-col items-center gap-1 rounded-lg px-2 py-1 text-[11px] font-medium {{ 'text-white' if home_active else 'text-slate-400 hover:text-white' }}"
          href="/"
        >
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path
              d="M4 10.5l8-6 8 6v8.5a1 1 0 0 1-1 1h-4.5a1 1 0 0 1-1-1v-4.5h-5V19a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1z"
              stroke="currentColor"
              stroke-width="1.6"
              stroke-linejoin="round"
            />
          </svg>
          <span>Home</span>
        </a>
        <a
          class="group flex min-w-0 flex-1 flex-col items-center gap-1 rounded-lg px-2 py-1 text-[11px] font-medium {{ 'text-white' if pricing_active else 'text-slate-400 hover:text-white' }}"
          href="/pricing"
        >
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path
              d="M6 7h12l-1.2 9.5a2 2 0 0 1-2 1.7H9.2a2 2 0 0 1-2-1.7z"
              stroke="currentColor"
              stroke-width="1.6"
              stroke-linejoin="round"
            />
            <path d="M9 7V5a3 3 0 0 1 6 0v2" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
          </svg>
          <span>Pricing</span>
        </a>
        <a
          class="group flex min-w-0 flex-1 flex-col items-center gap-1 rounded-lg px-2 py-1 text-[11px] font-medium {{ 'text-white' if about_active else 'text-slate-400 hover:text-white' }}"
          href="/about"
        >
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <circle cx="12" cy="12" r="8" stroke="currentColor" stroke-width="1.6" />
            <path d="M12 10v6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
            <circle cx="12" cy="7.5" r="1" fill="currentColor" />
          </svg>
          <span>About</span>
        </a>
        <a
          class="group flex min-w-0 flex-1 flex-col items-center gap-1 rounded-lg px-2 py-1 text-[11px] font-medium {{ 'text-white' if subscribe_active else 'text-slate-400 hover:text-white' }}"
          href="/subscribe"
        >
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path
              d="M4 6h16a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z"
              stroke="currentColor"
              stroke-width="1.6"
              stroke-linejoin="round"
            />
            <path d="M4 7l8 6 8-6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
          </svg>
          <span>Subscribe</span>
        </a>
      </div>
    </nav>

    <footer class="border-t border-slate-800">
      <div class="mx-auto max-w-6xl px-4 py-8 text-xs text-slate-500">
        Built with FastAPI. Original content/branding. <a class="hover:text-slate-300" href="/legal/privacy">Privacy</a> Â·
        <a class="hover:text-slate-300" href="/legal/terms">Terms</a>
      </div>
    </footer>

    <script>
      (function () {
        var env = window.__appEnv || {};
        var isStandalone = Boolean(env.isStandalone);
        var isSmallScreen = Boolean(env.isMobile);

        if (typeof env.isStandalone === "undefined") {
          var mediaStandalone = window.matchMedia && window.matchMedia("(display-mode: standalone)").matches;
          var mediaFullscreen = window.matchMedia && window.matchMedia("(display-mode: fullscreen)").matches;
          isStandalone = Boolean(window.navigator.standalone || mediaStandalone || mediaFullscreen);
        }

        if (typeof env.isMobile === "undefined") {
          isSmallScreen = window.matchMedia && window.matchMedia("(max-width: 639px)").matches;
        }

        var path = window.location.pathname || "/";
        var isAppPath = path.indexOf("/app") === 0;
        var isAuthPath =
          path.indexOf("/login") === 0 || path.indexOf("/signup") === 0 || path.indexOf("/logout") === 0;

        if (isSmallScreen && isStandalone && !isAppPath && !isAuthPath) {
          window.location.replace("/app");
          return;
        }

        var appGate = document.getElementById("standalone-required-overlay");
        var appGateVisible = false;
        if (appGate && isSmallScreen && !isStandalone && isAppPath) {
          appGate.classList.remove("hidden");
          document.body.classList.add("overflow-hidden");
          appGateVisible = true;
        }

        var banner = document.getElementById("install-banner");
        if (!banner) {
          return;
        }

        var closeButton = document.getElementById("install-banner-close");
        var dismissedKey = "installBannerDismissed";

        if (!isSmallScreen || isStandalone || appGateVisible) {
          banner.classList.add("hidden");
          return;
        }

        try {
          if (window.localStorage && window.localStorage.getItem(dismissedKey) === "1") {
            banner.classList.add("hidden");
            return;
          }
        } catch (err) {
          // Ignore storage errors.
        }

        var userAgent = window.navigator.userAgent || "";
        var isIOS = /iphone|ipad|ipod/i.test(userAgent);
        var iosText = banner.querySelector("[data-platform='ios']");
        var androidText = banner.querySelector("[data-platform='android']");

        if (iosText && androidText) {
          if (isIOS) {
            androidText.classList.add("hidden");
          } else {
            iosText.classList.add("hidden");
          }
        }

        if (closeButton) {
          closeButton.addEventListener("click", function () {
            banner.classList.add("hidden");
            try {
              if (window.localStorage) {
                window.localStorage.setItem(dismissedKey, "1");
              }
            } catch (err) {
              // Ignore storage errors.
            }
          });
        }
      })();
    </script>
  </body>
</html>
